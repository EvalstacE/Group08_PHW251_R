[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Simulated Infectious Disease Outbreak in California",
    "section": "",
    "text": "Project Description\nYou have been given three datasets: dataset one contains weekly data about a novel infectious respiratory disease outbreak containing the number of cases and case severity by demographic categories (age category, race, sex) and geographic categories (county) for California counties (except for Los Angeles county); dataset two contains morbidity and population data by similar demographic and geographic categories for Los Angeles county, and dataset three populations estimates for 2023 by county and demographic categories.\nOur role\nYou are an employee of the California Department of Public Health working on infectious disease surveillance.\nResearch question\nYour supervisors are interested to know the course of the outbreak, if it is disproportionately affecting certain demographic or geographic populations and how prevention and treatment resources should be allocated.\nData\nYou have been given three datasets:\n\nDataset one (sim_novelid_CA.csv) contains weekly data about cases and case severity by demographic categories (age category, race, sex) and geographic categories (county) for California counties (except for Los Angeles county);\nDataset two (sim_novelid_LACounty.csv) contains population data by similar demographic and geographic categories for Los Angeles county.\nDataset three (ca_pop_2023.csv) population estimates data by demographic category and county for 2023.\n\nData Merging, Summarization, and Reporting: Milestones 4-6\nFor milestones 4-6, you will join these datasets together to create a single dataset with aggregated summary morbidity and/or severity metrics and calculate rates. This dataset should be used to generate print-worthy visualizations (at least one table and one graph) to be included in the final report.",
    "crumbs": [
      "Project Description"
    ]
  },
  {
    "objectID": "chapters/chapter3/03a_project_setup.html",
    "href": "chapters/chapter3/03a_project_setup.html",
    "title": "1  Project Set-Up",
    "section": "",
    "text": "Bringing in libraries, helper functions, and data files:\n\n\nCode\n# Load and install packages\npacman::p_load(\n  dplyr, tidyr, ggplot2, lubridate, ggthemes, cowplot, readr, rlang,\n  classInt, tidycensus, sf, here, stringr, purrr, svglite, rmapshaper,\n  readxl, scales, ggrepel, viridis, RColorBrewer, maps, ggfx, glue,\n  knitr, kableExtra, janitor, reactable, MMWRweek\n)\n\n# Bring in helper functions\nfunc_dir &lt;- here::here(\"functions\")\nr_files &lt;- list.files(func_dir, pattern = \"\\\\.R$\", full.names = TRUE)\npurrr::walk(r_files, source)\n\n\n# Bring in datasets\ndata_dirs &lt;- c(\n  here::here(\"data\", \"tbl_outputs_03\"),\n  here::here(\"data\", \"cleaned_data\")\n)\n\ncsv_files &lt;- purrr::map(data_dirs, ~ list.files(\n  path = .x,\n  pattern = \"\\\\.csv$\",\n  full.names = TRUE\n)) %&gt;% unlist()\n\npurrr::walk(csv_files, function(file_path) {\n  obj_name &lt;- tools::file_path_sans_ext(basename(file_path))\n  df &lt;- readr::read_csv(file_path, show_col_types = FALSE)\n  assign(obj_name, df, envir = knitr::knit_global())\n})",
    "crumbs": [
      "Data Preparation",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Project Set-Up</span>"
    ]
  },
  {
    "objectID": "chapters/chapter3/03b_aligning_columns.html",
    "href": "chapters/chapter3/03b_aligning_columns.html",
    "title": "2  Aligning Column Names",
    "section": "",
    "text": "We brought in the raw datasets provided and first ensured that all column names referring to the same variables were consistent across the three databases, using the provided codebook as a reference. Standardizing these names improved both the efficiency of subsequent analyses and the clarity of the data dictionary developed later in this report.\nTo facilitate merging, we added a county field to the Los Angeles County database so that both datasets share the same set of columns, allowing them to be joined or appended to create a single statewide morbidity dataset for later analyses.\n\n\nCode\n##-- California dataset:\nca_df &lt;- raw_ca_df %&gt;% select(-dt_diagnosis) %&gt;%\n  mutate(\n    county = clean(county) %&gt;% \n      str_remove(\"\\\\s*[Cc]ounty$\") %&gt;% \n      str_trim()\n  )\n\n##-- LA county dataset:\nla_cnty_df &lt;- raw_la_cnty_df %&gt;%\n  rename(\n      \"age_cat\"                = \"age_category\", \n      \"race_ethnicity\"         = \"race_eth\",\n      \"new_infections\"         = \"dx_new\",\n      \"cumulative_infected\"    = \"infected_cumulative\",\n      \"new_unrecovered\"        = \"unrecovered_new\",\n      \"cumulative_unrecovered\" = \"unrecovered_cumulative\",\n      \"new_severe\"             = \"severe_new\",\n      \"cumulative_severe\"      = \"severe_cumulative\"\n  ) %&gt;%\n  mutate(county = \"Los Angeles\") %&gt;%\n  relocate(county, .before = everything()) \n\n##-- Population dataset:\npop_df &lt;- raw_pop_df %&gt;% \n  rename(\"race_ethnicity\" = \"race7\") %&gt;%\n  mutate(county = clean(county))\n\n\n\n\nAfter completing these adjustments — renaming columns in the Los Angeles County database and adding the county field — the remaining tasks involve reconciling the age category and race/ethnicity variable, and standardizing how the timing of infection is identified using MMWR weeks (see Figure 1 below).\n\n\nFigure 1. Aligning Column Names",
    "crumbs": [
      "Data Preparation",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Aligning Column Names</span>"
    ]
  },
  {
    "objectID": "chapters/chapter3/03c_age_groups.html",
    "href": "chapters/chapter3/03c_age_groups.html",
    "title": "3  Age Groups",
    "section": "",
    "text": "The population database contains counts for six age groups, whereas the California and LA County databases use four. Because the groupings align — “0–4,” “5–11,” and “12–17” in the population database correspond to the “0–17” group in the others — we summarized the population counts to match the four age-group format.\nIn the original population database, counts are reported for each single year of age within every demographic subgroup (e.g., county, sex, race/ethnicity). To obtain total estimates per age group and demographic category, the single-year counts were aggregated (summed).\nTable 1 below presents a subset of the original and restructured population data to illustrate the resulting summarized age groupings.\n\n\nCode\nstep2_pop_df &lt;- step1_pop_df %&gt;%\n  group_by(\n      county, health_officer_region, \n      sex, race_ethnicity, age_cat\n  ) %&gt;%\n  summarise(pop = sum(pop), .groups = \"drop\")\n\n#-aggregate population counts \n##--to 4 age category format:\nstep2_pop_df_recat &lt;- step1_pop_df %&gt;%\n  mutate(\n    new_age_group = \n      if_else(\n        age_cat %in% \n          c(\"0-4\", \"5-11\", \"12-17\"),\n              \"0-17\", age_cat)\n  ) %&gt;%\n  group_by(\n      county, health_officer_region, sex, \n      race_ethnicity, new_age_group\n  ) %&gt;%\n  summarise(pop = sum(pop), .groups = \"drop\") %&gt;%\n  rename(\"age_cat\" = \"new_age_group\")\n\n\n\nTable 1: Reconciling Age Group Categories and Population Counts\nOriginal Age Groups:\n\n\n\n\n\nCounty\nSex\nRace / Ethnicity\nAge Group\nPopulation\n\n\n\n\nAlameda\nFEMALE\nHispanic\n0-4\n11587\n\n\nAlameda\nFEMALE\nHispanic\n12-17\n17098\n\n\nAlameda\nFEMALE\nHispanic\n5-11\n17761\n\n\nTotal\n-\n-\n-\n46,446\n\n\n\n\n\nNew, Aggregate Age Group:\n\n\n\n\n\nCounty\nSex\nRace / Ethnicity\nAge Group\nPopulation\n\n\n\n\nAlameda\nFEMALE\nHispanic\n0-17\n46,446",
    "crumbs": [
      "Data Preparation",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Age Groups</span>"
    ]
  },
  {
    "objectID": "chapters/chapter3/03d_infection_dates.html",
    "href": "chapters/chapter3/03d_infection_dates.html",
    "title": "4  Infection Dates",
    "section": "",
    "text": "To support date-based analyses, infection records will be aggregated by MMWR week and year. For both the Los Angeles County and California datasets, we will generate two new columns: mmwr_year and mmwr_week, then remove the original date-based fields. We will also add columns start_date and end_date to serve as reference points should we need them later.\nIn the California dataset, the field time_int encodes the year and MMWR week as a six-digit integer (YYYYWW). To create the new fields, we extract the first four digits as mmwr_year and the last two digits as mmwr_week, then drop the original time_int column.\nIn the Los Angeles County dataset, the codebook identifies a field dt_report as the last day of the MMWR week. However, this field contained only missing values, so it was removed. Instead, we convert the infection date field, dt_dx to a proper date format, and then use the MMWRweek package to derive the mmwr_year and mmwr_week.\n\n\nCode\n##-- California dataset:\nstep2_ca_df &lt;- step1_ca_df %&gt;%\n##--pull MMWR week and year from time_int field\nmutate(\n  mmwr_year = factor(time_int %/% 100), \n  mmwr_week = factor(time_int %% 100)) %&gt;%\nadd_start_end_dates() %&gt;%\nselect(-time_int) %&gt;%\nrelocate(mmwr_year, mmwr_week, start_date, \n         end_date, .before = everything())\n\n\n##-- LA county dataset:\nstep2_la_cnty_df &lt;- step1_la_cnty_df %&gt;%\n##--restructure to proper date format\nmutate(DATE_FIX = \n  as.Date(parse_date_time(dt_dx, \"%d%b%Y\"), \n          format = \"%Y-%m-%d\")) %&gt;% \n##--use date to create new MMWR fields\nadd_mmwr_week_columns(date_col = \"DATE_FIX\") %&gt;%\nadd_start_end_dates() %&gt;%\nselect(-c(DATE_FIX, dt_dx)) %&gt;%\nrelocate(mmwr_year, mmwr_week, start_date, \n         end_date, .before = everything()) %&gt;%\nrelocate(county, .before = age_cat)\n\n\n\n\nTo streamline this process, we created two helper functions:\n\nadd_mmwr_week_columns() : takes date column and adds two fields: mmwr_year and mmwr_week\nadd_start_end_dates() : uses those values to generate corresponding MMWR week start and end dates\n\n\nThe dataframes now have a structure that looks like this:\n\n\n\n\n\nmmwr_year\nmmwr_week\nstart_date\nend_date\ncounty\nage_cat\nnew_infections\n\n\n\n\n2023\n22\n2023-05-28\n2023-06-03\nLos Angeles\n0-17\n15\n\n\n2023\n23\n2023-06-04\n2023-06-10\nLos Angeles\n0-17\n17\n\n\n2023\n24\n2023-06-11\n2023-06-17\nLos Angeles\n0-17\n23",
    "crumbs": [
      "Data Preparation",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Infection Dates</span>"
    ]
  },
  {
    "objectID": "chapters/chapter3/03e_race_ethnicity.html",
    "href": "chapters/chapter3/03e_race_ethnicity.html",
    "title": "5  Race and Ethnicity",
    "section": "",
    "text": "Each of the three datasets defines Race / Ethnicity differently. The California dataset uses numeric codes, the Los Angeles County dataset uses full text labels, and the population dataset uses abbreviated text.\nTo resolve this, we created a crosswalk file (race_ethnicity_map.csv) that aligns the three formats. By joining this crosswalk to each dataset, we ensure that all three contain a consistent set of race and ethnicity variables: each with the numeric code, the abbreviated text, and the full text label.\n\n\nCode\nrace_ethnicity_map &lt;- read.csv(file = here(\"data/race_ethnicity_map.csv\")) %&gt;%\n  mutate(\n    race_long = clean(race_long),\n    race_short = clean(race_short),\n    race_coded = as.character(race_coded)\n  )\n\n\n\n\nCode\nstep2_ca_df &lt;- step1_ca_df %&gt;%\n  rename(\"race_coded\" = \"race_ethnicity\") %&gt;%\n  mutate(race_coded = as.character(race_coded)) %&gt;%\n  left_join(race_ethnicity_map, by = \"race_coded\")%&gt;%\n  relocate(race_coded, race_short, race_long, .after = sex)\n\nstep2_la_cnty_df &lt;- step1_la_cnty_df %&gt;%\n  mutate(race_long = clean(race_ethnicity)) %&gt;%\n  select(-race_ethnicity) %&gt;%\n  left_join(race_ethnicity_map, by = \"race_long\") %&gt;%\n  relocate(race_coded, race_short, race_long, .after = sex)\n\n\n\nRace and Ethnicity Crosswalk Table:\n\n\n\n\n\nrace_coded\nrace_long\nrace_short\n\n\n\n\n1\nWhite, Non-Hispanic\nWhiteTE NH\n\n\n2\nBlack, Non-Hispanic\nBlack NH\n\n\n3\nAmerican Indian or Alaska Native, Non-Hispanic\nAIAN NH\n\n\n4\nAsian, Non-Hispanic\nAsian NH\n\n\n5\nNative Hawaiian or Pacific Islander, Non-Hispanic\nNHPI NH\n\n\n6\nMultiracial (two or more of above races), Non-Hispanic\nMR NH\n\n\n7\nHispanic (any race)\nHispanic\n\n\n9\nUnknown\nUnknown\n\n\n\n\n\n\nEach dataset now contains 3 columns for each unique race/ethnicity format, for example:\n\n\nCode\nstep2_ca_df %&gt;%\n  select(county, age_cat, sex, race_coded, race_short, race_long)%&gt;%\n  group_by(race_short)%&gt;%\n  slice_head(n=1)%&gt;%\n  rename_with(~cell_spec(\n    .x,\n    \"html\",\n    bold = TRUE,\n    color = \"#0f172a\",\n    background = \"#ffde59\",\n    font_size = 16\n  ), 4:6) %&gt;%\n  kbl(escape = FALSE, align = \"c\") %&gt;%\n  row_spec(0, \n       bold = TRUE, \n       background = \"#0f172a\",\n       extra_css = \"font-size: 16px!important;color:#ffffff;\") %&gt;%\n  kable_styling(bootstrap_options = c(\"bordered\"))\n\n\n\n\n\ncounty\nage_cat\nsex\nrace_coded\nrace_short\nrace_long\n\n\n\n\nAlameda\n0-17\nFEMALE\n3\nAIAN NH\nAmerican Indian or Alaska Native, Non-Hispanic\n\n\nAlameda\n0-17\nFEMALE\n4\nAsian NH\nAsian, Non-Hispanic\n\n\nAlameda\n0-17\nFEMALE\n2\nBlack NH\nBlack, Non-Hispanic\n\n\nAlameda\n0-17\nFEMALE\n7\nHispanic\nHispanic (any race)\n\n\nAlameda\n0-17\nFEMALE\n6\nMR NH\nMultiracial (two or more of above races), Non-Hispanic\n\n\nAlameda\n0-17\nFEMALE\n5\nNHPI NH\nNative Hawaiian or Pacific Islander, Non-Hispanic\n\n\nAlameda\n0-17\nFEMALE\n1\nWhiteTE NH\nWhite, Non-Hispanic",
    "crumbs": [
      "Data Preparation",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Race and Ethnicity</span>"
    ]
  },
  {
    "objectID": "chapters/chapter3/03f_population_counts.html",
    "href": "chapters/chapter3/03f_population_counts.html",
    "title": "6  Population by Demographic",
    "section": "",
    "text": "To calculate infection rates by demographic groups (such as county, health officer region, sex, or race/ethnicity), we first summarize total population counts for each demographic category within the population dataframe. The population dataset is then joined to both the master database (which merges all three datasets) and the individual California and Los Angeles datasets.\nBy creating and maintaining these summarized population counts, we avoid having to recalculate them each time we focus on a different demographic group. For example, once this population dataset is joined to the California data, we can easily calculate population-adjusted infection rates that allow valid comparisons across counties with differing population sizes.\n\n\nCode\nstep2_pop_df &lt;- step2_pop_df_recat %&gt;%\n  \n##-- join population database to the race/ethnicity map\n  mutate(race_short = clean(race_ethnicity)) %&gt;%\n  select(-race_ethnicity) %&gt;%\n  left_join(race_ethnicity_map, by = \"race_short\") %&gt;%\n  relocate(race_coded, race_short, race_long, .after = sex) %&gt;%\n  \n##-- calculate population totals by demographic\n  group_by(county, health_officer_region) %&gt;%\n    mutate(total_cnty_pop = sum(pop)) %&gt;% ungroup() %&gt;%\n  group_by(county, health_officer_region, race_coded, race_short, race_long) %&gt;%\n    mutate(total_race_pop = sum(pop)) %&gt;% ungroup() %&gt;%\n  group_by(county, health_officer_region, sex) %&gt;%\n    mutate(total_sex_pop = sum(pop)) %&gt;% ungroup() %&gt;%\n  group_by(health_officer_region) %&gt;%\n    mutate(total_HOR_pop = sum(pop)) %&gt;% ungroup()\n\n\n\n\nCode\n#--join datasets to new population dataframe\nstep2_ca_df &lt;- step2_ca_df %&gt;%\n  left_join(step2_pop_df, by = c(\"county\" ,\"sex\", \"race_coded\", \n            \"race_short\", \"race_long\", \"age_cat\")) %&gt;%\n  relocate(health_officer_region,  .after = county) %&gt;%\n  relocate(pop, .after = race_long) %&gt;%\n  mutate(age_cat = factor(age_cat, levels = c(\"0-17\", \"18-49\", \"50-64\", \"65+\")))\n\nstep2_la_cnty_df &lt;- step2_la_cnty_df %&gt;%\n  left_join(step2_pop_df, by = c(\"county\", \"sex\", \"race_coded\", \n            \"race_short\", \"race_long\", \"age_cat\")) %&gt;%\n  relocate(health_officer_region,  .after = county) %&gt;%\n  relocate(pop, .after = race_long) %&gt;%\n  mutate(age_cat = factor(age_cat, levels = c(\"0-17\", \"18-49\", \"50-64\", \"65+\")))\n\n\n\nTable 2: Calculating Infection Rate by 100,000 Population Example\n\n\nCode\nby_cnty_year &lt;- step2_ca_df %&gt;%\n  group_by(health_officer_region, county) %&gt;%\n  summarise(\n    total_cnty_pop = first(total_cnty_pop),\n    total_infected = max(cumulative_infected),\n    total_inf_prop = total_infected / total_cnty_pop,\n    inf_rate_100k = round((total_inf_prop * 10^4),1),\n    .groups = \"drop\"\n  )\n\ncnty_slice &lt;- by_cnty_year %&gt;%\n  select(-health_officer_region) %&gt;%\n  group_by(county) %&gt;%\n  slice(1) %&gt;%\n  ungroup() %&gt;%\n  slice_head(n=3)\n\ncnty_slice %&gt;%\nkbl(\n    escape = FALSE, \n    align = \"c\",\n    col.names = \n      c(\"County\", \"Total Population\", \n        \"Total Infected\", \"Proportion Infected\", \n        \"Infection Rate per 100K\")\n) %&gt;%\nrow_spec(0, \n       bold = TRUE, \n       background = \"#0f172a\",\n       extra_css = \"font-size: 16px!important;color:#ffffff;\"\n) %&gt;%\n  \ncolumn_spec(5, \n       bold = TRUE, \n       background = \"#5ce1e6\"\n) %&gt;%  \nkable_styling(bootstrap_options = c(\"bordered\"))\n\n\n\n\n\nCounty\nTotal Population\nTotal Infected\nProportion Infected\nInfection Rate per 100K\n\n\n\n\nAlameda\n1656037\n12427\n0.0075041\n75.0\n\n\nAlpine\n1165\n25\n0.0214592\n214.6\n\n\nAmador\n40122\n767\n0.0191167\n191.2",
    "crumbs": [
      "Data Preparation",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Population by Demographic</span>"
    ]
  },
  {
    "objectID": "chapters/chapter3/03g_creating_final_datasets.html",
    "href": "chapters/chapter3/03g_creating_final_datasets.html",
    "title": "7  Combined Database",
    "section": "",
    "text": "After reconciling all column names across the 3 datasets, standardizing age group, race/ethnicity, and infection date variables, we merge them together to generate a final, complete database and begin our descriptive explorations and analyses. The final, combined database as well as the cleaned individual datasets (California, Los Angeles, and population data) are stored and saved for future reference.\nDownload Combined Database (CSV)\n\n\nCode\nstep2_ca_df &lt;- read.csv(file = here(\"data/tbl_outputs_03/step2_ca_df.csv\"))\nstep2_la_cnty_df &lt;- read.csv(file = here(\"data/tbl_outputs_03/step2_la_cnty_df.csv\"))\nstep2_pop_df &lt;- read.csv(file = here(\"data/tbl_outputs_03/step2_pop_df.csv\"))\n\n\ncombined_df &lt;- rbind(step2_ca_df, step2_la_cnty_df) %&gt;%\n  relocate(health_officer_region,  .after = county) %&gt;%\n  relocate(pop, .after = race_long) %&gt;%\n  mutate(age_cat = factor(age_cat, levels = c(\"0-17\", \"18-49\", \"50-64\", \"65+\")))\n\n\nGlimpse of database structure:\n\n\nCode\ndplyr::glimpse(combined_df)\n\n\nRows: 100,688\nColumns: 22\n$ mmwr_year              &lt;dbl&gt; 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023,…\n$ mmwr_week              &lt;dbl&gt; 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,…\n$ start_date             &lt;date&gt; 2023-05-28, 2023-06-04, 2023-06-11, 2023-06-18…\n$ end_date               &lt;date&gt; 2023-06-03, 2023-06-10, 2023-06-17, 2023-06-24…\n$ county                 &lt;chr&gt; \"Alameda\", \"Alameda\", \"Alameda\", \"Alameda\", \"Al…\n$ health_officer_region  &lt;chr&gt; \"Bay Area\", \"Bay Area\", \"Bay Area\", \"Bay Area\",…\n$ age_cat                &lt;chr&gt; \"0-17\", \"0-17\", \"0-17\", \"0-17\", \"0-17\", \"0-17\",…\n$ sex                    &lt;chr&gt; \"FEMALE\", \"FEMALE\", \"FEMALE\", \"FEMALE\", \"FEMALE…\n$ race_coded             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ race_short             &lt;chr&gt; \"WhiteTE NH\", \"WhiteTE NH\", \"WhiteTE NH\", \"Whit…\n$ race_long              &lt;chr&gt; \"White, Non-Hispanic\", \"White, Non-Hispanic\", \"…\n$ pop                    &lt;dbl&gt; 34155, 34155, 34155, 34155, 34155, 34155, 34155…\n$ new_infections         &lt;dbl&gt; 6, 1, 2, 10, 19, 25, 23, 18, 22, 35, 29, 43, 69…\n$ cumulative_infected    &lt;dbl&gt; 6, 7, 9, 19, 38, 63, 86, 104, 126, 161, 190, 23…\n$ new_unrecovered        &lt;dbl&gt; 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 3, 2,…\n$ cumulative_unrecovered &lt;dbl&gt; 0, 1, 1, 1, 1, 2, 2, 3, 4, 5, 6, 6, 7, 7, 10, 1…\n$ new_severe             &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ cumulative_severe      &lt;dbl&gt; 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ total_cnty_pop         &lt;dbl&gt; 1656037, 1656037, 1656037, 1656037, 1656037, 16…\n$ total_race_pop         &lt;dbl&gt; 485940, 485940, 485940, 485940, 485940, 485940,…\n$ total_sex_pop          &lt;dbl&gt; 849329, 849329, 849329, 849329, 849329, 849329,…\n$ total_HOR_pop          &lt;dbl&gt; 8391874, 8391874, 8391874, 8391874, 8391874, 83…",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Combined Database</span>"
    ]
  },
  {
    "objectID": "chapters/chapter3/03h_final_data_dictionary.html",
    "href": "chapters/chapter3/03h_final_data_dictionary.html",
    "title": "8  Final Data Dictionary",
    "section": "",
    "text": "Download Data Dictionary (CSV)\n\n\nCode\ndata_dictionary &lt;- read.csv(file = here(\"data/final_codebook.csv\"))\n\n\n\nCategorical, Dates, and Factors:\n\n\nCode\ndata_dictionary %&gt;% filter(class != \"integer\") %&gt;%\nkbl(\n  align = \"cclcc\", \n  col.names = \n    c(\"Variable Name\", \"Class/Type\", \"Definition\", \n      \"Unique Values\", \"Example Format\")\n) %&gt;%\nkable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"bordered\")\n) %&gt;%\nrow_spec(0, \n   bold = TRUE, \n   background = \"#0f172a\",\n   extra_css = \"font-size: 16px!important;color:#ffffff;\"\n)\n\n\n\n\n\nVariable Name\nClass/Type\nDefinition\nUnique Values\nExample Format\n\n\n\n\nend_date\nDate\nlast date of Epi week\n31\nformat: 2023-06-03\n\n\nstart_date\nDate\nfirst date of Epi week\n31\nformat: 2023-05-28\n\n\ncounty\ncharacter\ncounty of residence of cases\n58\nAlameda\n\n\nhealth_officer_region\ncharacter\nCalifornia Health Officer Region\n6\nBay Area\n\n\nrace_coded\ncharacter\nrace category codes\n7\n1, 2, 3, 4, 5, 6, 7\n\n\nrace_long\ncharacter\nrace category full text\n7\nBlack, Non-Hispanic\n\n\nrace_short\ncharacter\nrace category abbreviated text\n7\nBlack NH\n\n\nsex\ncharacter\nsex categorization\n2\nFEMALE, MALE\n\n\nage_cat\nfactor\nage category\n4\n0-17, 18-49, 50-64, 65+\n\n\nmmwr_week\nfactor\nepi week 40 in 2022 to epi week 23 in 2023\n31\n22:52\n\n\nmmwr_year\nfactor\nyear\n1\n2023\n\n\n\n\n\n\n\nNumeric:\n\n\nCode\ndata_dictionary %&gt;% \n  filter(class == \"integer\") %&gt;%\n  select(-unique_n) %&gt;%\n  \nkbl(\n  align = \"cclc\", \n  col.names = \n    c(\"Variable Name\", \"Class/Type\", \"Definition\", \n      \"Range of Values\")\n) %&gt;%\nkable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"bordered\")\n) %&gt;%\nrow_spec(0, \n   bold = TRUE, \n   background = \"#0f172a\",\n   extra_css = \"font-size: 16px!important;color:#ffffff;\"\n)\n\n\n\n\n\nVariable Name\nClass/Type\nDefinition\nRange of Values\n\n\n\n\ncumulative_infected\ninteger\ntotal number of diagnosed individuals\n0 - 137804\n\n\ncumulative_severe\ninteger\ntotal number infected requiring hospitalization\n0 - 4060\n\n\ncumulative_unrecovered\ninteger\ntotal number unrecovered after a week of diagnosis\n0 - 16920\n\n\nnew_infections\ninteger\nnewly diagnosed individuals\n0 - 12110\n\n\nnew_severe\ninteger\nnewly identified cases requiring hospitalization\n0 - 352\n\n\nnew_unrecovered\ninteger\nnewly reported as unrecovered\n0 - 1436\n\n\npop\ninteger\nestimated population by age group for year 2023\n0 - 980387\n\n\ntotal_cnty_pop\ninteger\ntotal population estimate by county\n1165 - 9825708\n\n\ntotal_race_pop\ninteger\ntotal county population by race/ethnicity\n0 - 4089110\n\n\ntotal_sex_pop\ninteger\ntotal county pouplation by sex\n548 - 5049625\n\n\ntotal_HOR_pop\ninteger\ntotal population by Health Officer Region\n683715 - 12802429",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Final Data Dictionary</span>"
    ]
  },
  {
    "objectID": "chapters/chapter3/03i_descriptive_stats.html",
    "href": "chapters/chapter3/03i_descriptive_stats.html",
    "title": "9  Infection Rates by Demographic",
    "section": "",
    "text": "9.1 Calculating Crude Rates\nTo simplify and standardize the process of calculating crude infection rates across multiple demographic groupings, we created a custom helper function: calc_total_rates_pop()\nThe main arguments are:\nCode\ncalc_total_rates_pop &lt;- function(df, ..., pop_col) {\n  df %&gt;%\n    group_by(...) %&gt;%\n    summarise(\n      total_pop = first({{ pop_col }}),\n      total_infected = max(cumulative_infected, na.rm = TRUE),\n      total_inf_prop = total_infected / total_pop,\n      inf_rate_100k = round(total_inf_prop * 1e5, 1),\n      total_severe = max(cumulative_severe, na.rm = TRUE),\n      total_sev_prop = total_severe / total_pop,\n      sev_rate_100k = round(total_sev_prop * 1e5, 1),\n      total_unrec = max(cumulative_unrecovered, na.rm = TRUE),\n      total_unrec_prop = total_unrec / total_pop,\n      unrec_rate_100k = round(total_unrec_prop * 1e5, 1),\n      .groups = \"drop\"\n    )\n}\nThis function automatically summarizes infection data by one or more grouping variables (for example, county, sex, or race/ethnicity) and computes total population counts, cumulative infection counts, and corresponding crude rates per 100,000 population. It ensures consistent calculations across datasets and minimizes the need to repeat long dplyr pipes for each demographic of interest.\nCode\n#- by Health Officer Region\nby_HOR &lt;-\n  calc_total_rates_pop(df, pop_col = total_HOR_pop, health_officer_region)\n\n#- by County\nby_cnty &lt;-\n  calc_total_rates_pop(df, pop_col = total_cnty_pop, health_officer_region, county) \n\n#- by Age Category\nby_age &lt;- \n  calc_total_rates_pop(df, pop_col = pop, age_cat) \n\n#- by Sex\nby_sex &lt;-\n  calc_total_rates_pop(df, pop_col = total_sex_pop, sex) \n\n#- by Race and Ethnicity\nby_race &lt;-\n  calc_total_rates_pop(df, pop_col = total_race_pop, race_long)",
    "crumbs": [
      "Descriptive Exploration",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Infection Rates by Demographic</span>"
    ]
  },
  {
    "objectID": "chapters/chapter3/03i_descriptive_stats.html#calculating-crude-rates",
    "href": "chapters/chapter3/03i_descriptive_stats.html#calculating-crude-rates",
    "title": "9  Infection Rates by Demographic",
    "section": "",
    "text": "df : name of the combined dataframe object\n... : column name(s) of grouping variables (comma-separated if more than one)\npop_col : column name of the population count that should be used to calculate rates",
    "crumbs": [
      "Descriptive Exploration",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Infection Rates by Demographic</span>"
    ]
  },
  {
    "objectID": "chapters/chapter3/03i_descriptive_stats.html#severe-infection-rates-by-demographic",
    "href": "chapters/chapter3/03i_descriptive_stats.html#severe-infection-rates-by-demographic",
    "title": "9  Infection Rates by Demographic",
    "section": "9.2 Severe Infection Rates by Demographic",
    "text": "9.2 Severe Infection Rates by Demographic\n\nHealth Officer RegionCountyAge CategorySexRace/Ethnicity\n\n\n\n\n\n\n\nhealth_officer_region\ntotal_pop\ninf_rate_100k\nsev_rate_100k\n\n\n\n\nGreater Sierra Sacramento\n2973210\n1184.0\n72.3\n\n\nLos Angeles\n9825708\n1402.5\n41.3\n\n\nRural North\n683715\n434.2\n31.4\n\n\nCentral California\n4432134\n902.8\n23.8\n\n\nSouthern California\n12802429\n626.2\n17.3\n\n\nBay Area\n8391874\n189.5\n11.4\n\n\n\n\n\n\n\nTop 10 Highest Severe Infection Rates by County\n\n\n\n\n\ncounty\ntotal_pop\ninf_rate_100k\nsev_rate_100k\n\n\n\n\nInyo\n18731\n4623.4\n427.1\n\n\nImperial\n179639\n10494.4\n338.5\n\n\nSierra\n3152\n2918.8\n317.3\n\n\nAlpine\n1165\n2145.9\n257.5\n\n\nTehama\n64677\n3110.8\n218.0\n\n\nPlumas\n18955\n3001.8\n211.0\n\n\nCalaveras\n44605\n2475.1\n190.6\n\n\nMariposa\n16860\n2437.7\n189.8\n\n\nModoc\n8446\n2439.0\n189.4\n\n\nSan Luis Obispo\n280251\n2158.8\n173.4\n\n\n\n\n\n\n\n\n\n\n\n\nage_cat\ntotal_pop\ninf_rate_100k\nsev_rate_100k\n\n\n\n\n65+\n57881\n86733.1\n7014.4\n\n\n18-49\n99574\n138393.6\n1611.9\n\n\n50-64\n51121\n49251.8\n289.5\n\n\n0-17\n34155\n51456.6\n55.6\n\n\n\n\n\n\n\ninitial note: males have higher infection rate; but females have higher rates of severe infections and unrecovered\n\n\n\n\n\nsex\ntotal_pop\ninf_rate_100k\nsev_rate_100k\n\n\n\n\nFEMALE\n849329\n15316.8\n478.0\n\n\nMALE\n806708\n17082.3\n419.6\n\n\n\n\n\n\n\ninitial note: Hispanic population has highest infection rate, severe infection rate, and unrecovered rate – all across the board – this community is being impacted the most.\n\n\n\n\n\nrace_long\ntotal_pop\ninf_rate_100k\nsev_rate_100k\n\n\n\n\nHispanic (any race)\n335452\n41080.1\n1015.3\n\n\nWhite, Non-Hispanic\n485940\n11033.5\n835.5\n\n\nAmerican Indian or Alaska Native, Non-Hispanic\n4569\n11775.0\n744.1\n\n\nBlack, Non-Hispanic\n157817\n11989.2\n621.0\n\n\nAsian, Non-Hispanic\n568612\n5079.7\n345.9\n\n\nNative Hawaiian or Pacific Islander, Non-Hispanic\n14710\n6233.9\n163.2\n\n\nMultiracial (two or more of above races), Non-Hispanic\n88937\n6127.9\n133.8\n\n\n\n\n\n\n\n\nCode for table subsets:\n\n\nCode\nHOR_filt &lt;- make_rate_table(\n  by_HOR,\n  health_officer_region,\n  pop_col = total_pop,\n  sort_by = \"sev_rate_100k\",\n  top_n = NULL,                 \n  drop_cols = \"unrec_rate_100k\",\n  highlight_col = \"sev_rate_100k\"\n)\n\ncnty_filt &lt;- make_rate_table(\n  by_cnty,\n  county,\n  pop_col = total_pop,\n  sort_by = \"sev_rate_100k\",\n  top_n = 10,\n  drop_cols = \"unrec_rate_100k\",\n  highlight_col = \"sev_rate_100k\"\n)\n\n\nage_filt &lt;- make_rate_table(\n  by_age,\n  age_cat,\n  pop_col = total_pop,\n  sort_by = \"sev_rate_100k\",\n  top_n = NULL,                 \n  drop_cols = \"unrec_rate_100k\",\n  highlight_col = \"sev_rate_100k\"\n)\n\n\nsex_filt &lt;- make_rate_table(\n  by_sex,\n  sex,\n  pop_col = total_pop,\n  sort_by = \"sev_rate_100k\",\n  top_n = NULL,                 \n  drop_cols = \"unrec_rate_100k\",\n  highlight_col = \"sev_rate_100k\"\n)\n\n\nrace_filt &lt;- make_rate_table(\n  by_race,\n  race_long,\n  pop_col = total_pop,\n  sort_by = \"sev_rate_100k\",\n  top_n = NULL,                 \n  drop_cols = \"unrec_rate_100k\",\n  highlight_col = \"sev_rate_100k\"\n)",
    "crumbs": [
      "Descriptive Exploration",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Infection Rates by Demographic</span>"
    ]
  }
]